(window.webpackJsonp=window.webpackJsonp||[]).push([[39],{275:function(v,_,t){"use strict";t.r(_);var a=t(5),e=Object(a.a)({},(function(){var v=this,_=v.$createElement,t=v._self._c||_;return t("ContentSlotsDistributor",{attrs:{"slot-key":v.$parent.slotKey}},[t("p"),t("div",{staticClass:"table-of-contents"},[t("ul",[t("li",[t("a",{attrs:{href:"#丢失修改"}},[v._v("丢失修改")])]),t("li",[t("a",{attrs:{href:"#读脏数据"}},[v._v("读脏数据")])]),t("li",[t("a",{attrs:{href:"#不可重复读（读取了提交的新事物，指增删操作）"}},[v._v("不可重复读（读取了提交的新事物，指增删操作）")])]),t("li",[t("a",{attrs:{href:"#幻读（读取了提交的新事物，指增删操作）"}},[v._v("幻读（读取了提交的新事物，指增删操作）")])]),t("li",[t("a",{attrs:{href:"#读写锁"}},[v._v("读写锁")])])])]),t("p"),v._v(" "),t("p",[v._v("在并发环境下，事务的隔离性很难保证，因此会出现很多并发一致性问题。")]),v._v(" "),t("h2",{attrs:{id:"丢失修改"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#丢失修改","aria-hidden":"true"}},[v._v("#")]),v._v(" 丢失修改")]),v._v(" "),t("p",[t("code",[v._v("T1")]),v._v(" 和 "),t("code",[v._v("T2")]),v._v(" 两个事务都对一个数据进行修改，"),t("code",[v._v("T1")]),v._v(" 先修改，"),t("code",[v._v("T2")]),v._v(" 随后修改，"),t("code",[v._v("T2")]),v._v(" 的修改覆盖了 "),t("code",[v._v("T1")]),v._v(" 的修改。")]),v._v(" "),t("p",[t("img",{attrs:{src:"https://s2.ax1x.com/2019/09/03/nkYU9f.png",alt:""}})]),v._v(" "),t("p",[v._v("很明显的看出，旺财对"),t("code",[v._v("A")]),v._v("添加的"),t("code",[v._v("20")]),v._v("块不翼而飞了，这就是“数据丢失”，对事务不加任何锁（不存在事务隔离），就会导致这种问题。")]),v._v(" "),t("h2",{attrs:{id:"读脏数据"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#读脏数据","aria-hidden":"true"}},[v._v("#")]),v._v(" 读脏数据")]),v._v(" "),t("p",[v._v("操作：写数据的时候添加一个"),t("strong",[v._v("X锁（排他锁）")]),v._v("，也就是在写数据的时候不允许其他事务进行写操作，但是读不受限制，读不加锁。")]),v._v(" "),t("p",[t("img",{attrs:{src:"https://s2.ax1x.com/2019/09/03/nkYrHs.png",alt:""}})]),v._v(" "),t("p",[v._v("这样就可以解决了多个人一起写数据而导致了“数据丢失”的问题，但是会引发新的问题——脏读。")]),v._v(" "),t("p",[v._v("脏读：读取了别人未提交的数据。")]),v._v(" "),t("p",[t("img",{attrs:{src:"https://s2.ax1x.com/2019/09/03/nkYyEn.png",alt:""}})]),v._v(" "),t("h2",{attrs:{id:"不可重复读（读取了提交的新事物，指增删操作）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#不可重复读（读取了提交的新事物，指增删操作）","aria-hidden":"true"}},[v._v("#")]),v._v(" 不可重复读（读取了提交的新事物，指增删操作）")]),v._v(" "),t("p",[v._v("操作：写数据的时候加上"),t("code",[v._v("X")]),v._v("锁（排他锁），读数据的时候添加"),t("strong",[v._v("S锁（共享锁）")]),v._v("，而且有约定：如果一个数据加了"),t("code",[v._v("X")]),v._v("锁就没法加"),t("code",[v._v("S")]),v._v("锁；同理如果加了"),t("code",[v._v("S")]),v._v("锁就没法加"),t("code",[v._v("X")]),v._v("锁，但是一个数据可以同时存在多个"),t("code",[v._v("S")]),v._v("锁（因为只是读数据），并且规定"),t("code",[v._v("S")]),v._v("锁读取数据，一旦读取完成就立刻释放"),t("code",[v._v("S")]),v._v("锁（不管后续是否还有很多其他的操作，只要是读取了"),t("code",[v._v("S")]),v._v("锁的数据后，就立刻释放"),t("code",[v._v("S")]),v._v("锁）。")]),v._v(" "),t("p",[t("img",{attrs:{src:"https://s2.ax1x.com/2019/09/03/nkY1nH.png",alt:""}})]),v._v(" "),t("p",[v._v("这样就解决了脏读的问题，但是又有新的问题出现——不可重复读。")]),v._v(" "),t("p",[v._v("不可重复读：同一个事务对数据的多次读取的结果不一致。")]),v._v(" "),t("p",[t("img",{attrs:{src:"https://s2.ax1x.com/2019/09/03/nkYa38.png",alt:""}})]),v._v(" "),t("h2",{attrs:{id:"幻读（读取了提交的新事物，指增删操作）"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#幻读（读取了提交的新事物，指增删操作）","aria-hidden":"true"}},[v._v("#")]),v._v(" 幻读（读取了提交的新事物，指增删操作）")]),v._v(" "),t("p",[v._v("操作：对"),t("code",[v._v("S")]),v._v("锁进行修改，之前的"),t("code",[v._v("S")]),v._v("锁是：读取了数据之后就立刻释放"),t("code",[v._v("S")]),v._v("锁，现在修改是：在读取数据的时候加上"),t("code",[v._v("S")]),v._v("锁，但是要直到事务准备提交了才释放该"),t("code",[v._v("S")]),v._v("锁，"),t("code",[v._v("X")]),v._v("锁还是一致。")]),v._v(" "),t("p",[t("img",{attrs:{src:"https://s2.ax1x.com/2019/09/03/nkYBuQ.png",alt:""}})]),v._v(" "),t("p",[v._v("这样就解决了不可重复读的问题了，但是又有新的问题出现——幻读。")]),v._v(" "),t("p",[v._v("例如：")]),v._v(" "),t("p",[v._v("有一次旺财对一个“学生表”进行操作，选取了年龄是18岁的所有行， 用"),t("code",[v._v("X")]),v._v("锁锁住， 并且做了修改。")]),v._v(" "),t("p",[v._v("改完以后旺财再次选择所有年龄是18岁的行， 想做一个确认， 没想到有一行竟然没有修改！")]),v._v(" "),t("p",[v._v("这是怎么回事？ 出了幻觉吗？")]),v._v(" "),t("p",[v._v("原来就在旺财查询并修改的的时候， 小强也对学生表进行操作， 他插入了一个新的行，其中的年龄也是18岁！ 虽然两个人的修改都没有问题， 互不影响， 但从最终效果看， 还是出了事。")]),v._v(" "),t("h2",{attrs:{id:"读写锁"}},[t("a",{staticClass:"header-anchor",attrs:{href:"#读写锁","aria-hidden":"true"}},[v._v("#")]),v._v(" 读写锁")]),v._v(" "),t("p",[v._v("读写锁")]),v._v(" "),t("ul",[t("li",[v._v("排它锁（Exclusive），简写为 "),t("code",[v._v("X")]),v._v(" 锁，又称写锁。")]),v._v(" "),t("li",[v._v("共享锁（Shared），简写为 "),t("code",[v._v("S")]),v._v(" 锁，又称读锁。")])]),v._v(" "),t("p",[v._v("有以下两个规定：")]),v._v(" "),t("ul",[t("li",[v._v("一个事务对数据对象 "),t("code",[v._v("A")]),v._v(" 加了 "),t("code",[v._v("X")]),v._v(" 锁，就可以对 "),t("code",[v._v("A")]),v._v(" 进行读取和更新。加锁期间其它事务不能对 "),t("code",[v._v("A")]),v._v(" 加任何锁。")]),v._v(" "),t("li",[v._v("一个事务对数据对象 "),t("code",[v._v("A")]),v._v(" 加了 "),t("code",[v._v("S")]),v._v(" 锁，可以对 "),t("code",[v._v("A")]),v._v(" 进行读取操作，但是不能进行更新操作。加锁期间其它事务能对 "),t("code",[v._v("A")]),v._v(" 加 "),t("code",[v._v("S")]),v._v(" 锁，但是不能加 "),t("code",[v._v("X")]),v._v(" 锁。")])])])}),[],!1,null,null,null);_.default=e.exports}}]);